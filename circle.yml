machine:
  environment:
    CIRCLE_BUILD_DIR: $HOME/$CIRCLE_PROJECT_REPONAME
    PATH: $PATH:$CIRCLE_BUILD_DIR/bin
  post:
    - mkdir -p $CIRCLE_BUILD_DIR/bin

dependencies:
  pre:
    - go get -v github.com/JacksonConsulting/s3up
  cache_directories:
    - bin
test:
  override:
    - echo "YAY!"
deployment:
  zip:
    branch: master
    commands:
      - cd $VIRTUAL_ENV/lib/python2.7/site-packages
      - zip -9 ~/route53_backups.zip *
      - cd $VIRTUAL_ENV/lib64/python2.7/site-packages
      - zip -r9 ~/route53_backups.zip *
      - cd ~
      - zip -g route53_backups.zip functions/handlers.py
      - zip -g route53_backups.zip functions/route53_backups.py
  s3up:
    branch: master
    commands:
      - s3up -source=~/route53_backups.zip -bucket=$BUCKET
#  cli53:
#    branch: master
#    commands:
#      - cli53 list | grep 'Name:*' | cut -f6- -d' ' | while read line; do cli53 export ${line} >> backup/${line}bk; done
#  s3up:
#    branch: master
#    commands:
#      - s3up -source=backup/ -bucket=$BUCKET


#https://github.com/barnybug/cli53/releases/download/0.8.7/cli53-linux-amd64
#$ sudo mv cli53-my-platform /usr/local/bin/cli53
#$ sudo chmod +x /usr/local/bin/cli53
#
